<?php if (!defined('inpanel')) die("no access");global $config;global $db;global $content;ob_start();$global_acs = get_accesslvl();if($_REQUEST["addd"]){ if ($global_acs==100) {  $error = false;  $alname = substr(validate($_POST["admname"]),0,10);  $anpwd = substr(validate($_POST["admpwd"]),0,10);  $anikc = substr(validate($_POST["admnick"]),0,10);  $access = substr(validate($_POST["admacs"]),0,3);    $query = $db->query("SELECT * FROM MWC_admin");  while($getlist = $db->fetchrow($query))  {   if($getlist[1]== $alname)   {    $error = true;    break;   }  }   if($error==false)  {   $db->query("INSERT INTO MWC_admin (name,pwd,nick,access)VALUES('".$alname."','".md5($anpwd)."','".$anikc."','".$access."')");   WriteLogs ("Adm_","администратор ".$_SESSION["sadmin"]." добавил $alname в качестве администратора");   header("Location:".$config["siteaddress"]."/control.php?page=eddingadm");  } } else  echo "<div style='text-align:center'>You don't have access to use this module</div>";}elseif($_REQUEST["edittt"]){ $alname = substr(validate($_POST["admname"]),0,10); $anpwd = substr(validate($_POST["admpwd"]),0,10); $anikc = substr(validate($_POST["admnick"]),0,10);  $query = $db->numrows("SELECT name FROM MWC_admin WHERE name='".$alname."'");  if($query==1) {  if ($global_acs==100 or $alname==$_SESSION["sadmin"])  {   if ($global_acs==100) $access = substr(validate($_POST["admacs"]),0,3);   else $access=$global_acs;      if ($anpwd=!"md5hash")       $db->query("UPDATE MWC_admin SET pwd = '".md5($anpwd)."', [access] ='".$access."', [nick]='".$anikc."' WHERE name='".$alname."'");    else       $db->query("UPDATE MWC_admin SET [access] ='".$access."', [nick]='".$anikc."' WHERE name='".$alname."'");   WriteLogs ("Adm_","администратор ".$_SESSION["sadmin"]." изменил ".$alname."'у пароль или уровень доступа");  } } header("Location:".$config["siteaddress"]."/control.php?page=eddingadm");}if(!$_GET["act"]){ $content->out_content("_sysvol/_a/theme/edda_h.html"); $query = $db->query("SELECT * FROM MWC_admin"); while($getlist = $db->fetchrow($query)) {  $content->set('|adm_aval|',  $getlist[1]);  if(trim($getlist[1])!=$_SESSION["sadmin"])     $content->set('|adm_oval|',  "<a href='".$config["siteaddress"]."/control.php?page=eddingadm&act=edit&editid=".$getlist[0]."'>[Edit]</a>&nbsp;<a href='".$config["siteaddress"]."/control.php?page=eddingadm&act=del&delid=".$getlist[0]."'>[Delete]</a>");  else    $content->set('|adm_oval|',  "<a href='".$config["siteaddress"]."/control.php?page=eddingadm&act=edit&editid=".$getlist[0]."'>[Edit]</a>");      $content->out_content("_sysvol/_a/theme/edda_c.html"); } $content->out_content("_sysvol/_a/theme/edda_f.html");}else{ switch($_GET["act"]) {  case "add":   if($global_acs==100)  {   $content->set('|adm_aval|',  "");   $content->set('|adm_apwd|',  "");   $content->set('|adm_anick|',  "");   $content->set('|adm_acs|',  1);   $content->set('|adm_bname|',  "addd");   $content->out_content("_sysvol/_a/theme/edda_edit.html");  }  else   echo "<div style='text-align:center'>You don't have access to use this module</div>";  break;  case "edit":  $eid = checknum(substr($_GET["editid"],0,2));   $chec = $db->fetchrow("SELECT [name],[access],[nick] FROM MWC_admin WHERE id=".$eid."");  if ($chec[0]==$_SESSION["sadmin"] or $global_acs==100)  {     $content->set('|adm_bname|',  "edittt");   $content->set('|adm_aval|',  $chec[0]);   $content->set('|adm_acs|',  $chec[1]);   $content->set('|adm_anick|',  $chec[2]);   $content->set('|adm_apwd|',  "md5hash");   $content->out_content("_sysvol/_a/theme/edda_edit.html");  }  else   echo "<div style='text-align:center'>You don't have access to use this module</div>";  break;  case "del":   if($global_acs==100)   {    $did = checknum(substr($_GET["delid"],0,2));    $chec = $db->fetchrow("SELECT name FROM MWC_admin WHERE id='". $did."'");    if ($chec[0]!=$_SESSION["sadmin"])    {     $db->query("DELETE FROM MWC_admin WHERE id='". $did."'");     WriteLogs ("Adm_","администратор ".$_SESSION["sadmin"]." удалил администратора $chec[0]");    }    else WriteLogs ("Adm_","администратор ".$_SESSION["sadmin"]." пытался удалить сам себя о0");    header("Location:".$config["siteaddress"]."/control.php?page=eddingadm");   }   else    echo "<div style='text-align:center'>You don't have access to use this module</div>";   break;  default:die("wrong action type!"); }}$temp = ob_get_contents();ob_end_clean(); 